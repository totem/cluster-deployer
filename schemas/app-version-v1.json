{
  "$schema": "http://json-schema.org/draft-04/hyper-schema#",
  "type": "object",
  "title": "Schema for creating deployment",
  "id": "#app-version-v1",
  "properties": {
    "meta-info": {
      "$ref": "#/definitions/meta-info"
    },
    "deployment":{
      "$ref": "#/definitions/deployment"
    },
    "proxy":{
      "$ref": "#/definitions/proxy"
    },
    "templates": {
      "$ref": "#/definitions/templates"
    }
  },
  "required": ["meta-info"],
  "additionalProperties": false,
  "definitions":{
    "meta-info": {
      "properties": {
        "git": {
          "$ref": "#/definitions/git"
        },
        "job-id": {
          "type": "string",
          "maxLength": 100
        }
      },
      "additionalProperties": false
    },
    "git": {
      "properties": {
        "owner": {
          "type": "string",
          "maxLength": 100
        },
        "repo": {
          "type": "string",
          "maxLength": 100
        },
        "ref": {
          "type": "string",
          "maxLength": 100
        },
        "commit": {
          "type": "string",
          "maxLength": 100
        }
      },
      "additionalProperties": false
    },
    "deployment": {
      "properties": {
        "name": {
          "type": "string",
          "maxLength": 512
        },
        "version": {
          "type": "string",
          "maxLength": 100
        },
        "type": {
          "enum": [ "blue-green", "red-green", "a/b", "custom"]
        },
        "check": {
          "type": "object"
        }
      },
      "additionalProperties": false
    },
    "proxy":{
      "properties": {
        "hosts": {
          "type": "object"
        },
        "listeners": {
          "type": "object"
        }
      },
      "additionalProperties": false
    },
    "templates": {
      "properties": {
        "app": {
          "$ref": "#/definitions/template"
        }
      },
      "additionalProperties": true
    },
    "template": {
      "properties": {
        "args": {
          "$ref": "#/definitions/template-args"
        }
      },
      "additionalProperties": true
    },
    "template-args": {
      "properties": {
        "image": {
          "type": "string",
          "maxLength": 1024
        }
      }
    }
  },
  "links": [
    {
      "rel": "self",
      "href": "${base_url}/api/secure/hosts/{id}",
      "mediaType": "application/vnd.saleztoolz.host-v1+json",
      "method": "GET"
    },
    {
      "title": "List Hosts",
      "rel": "parent",
      "href": "/api/secure/hosts",
      "mediaType": "application/vnd.saleztoolz.host-list-v1+json",
      "method": "GET"
    },
    {
      "title": "Updates basic host info",
      "rel": "patch",
      "href": "/api/secure/hosts/{id}",
      "mediaType": "application/vnd.saleztoolz.host-patch-v1+json",
      "method": "PUT"
    },
    {
      "title": "Deletes the host from the system",
      "rel": "delete",
      "href": "/api/secure/hosts/{id}",
      "method": "DELETE"
    }
  ]
}